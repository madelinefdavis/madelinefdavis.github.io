<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>0282a4a99e964b4383d3874ca48c3f84</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="i9_ZJYSJIqHR">
<p>#PCOS Flagger: A Predictive System for Accessible Early Screening
(Milestone 2)</p>
<p>By: Nysa Bhat and Madeline Davis</p>
</div>
<div class="cell markdown" id="CmwYu9s1uoiM">
<p><a href="https://">link text</a><a
href="https://github.com/madelinefdavis/madelinefdavis.github.io">project
website link</a></p>
</div>
<div class="cell markdown" id="XPN66riquYSV">
<p>#Project Goals</p>
</div>
<div class="cell markdown" id="09xqs9w4uTct">
<p>Our final project focuses on building a predictive model to determine
whether an individual has Polycystic Ovary Syndrome (PCOS), a hormonal
disorder affecting approximately 15% of women of reproductive age. PCOS
is characterized by elevated androgen levels and symptoms such as
irregular periods, acne, obesity, hair thinning, and infertility. While
PCOS is not curable, its symptoms can be managed through medical and
lifestyle interventions. The data set we are using can be found <a
href="https://www.kaggle.com/datasets/shreyasvedpathak/pcos-dataset/data">here</a>
which we got from Kaggle. Using a dataset of 541 women collected via
survey, which includes both PCOS diagnoses and clinical features, we aim
to:</p>
<ul>
<li>Develop a classification model to predict PCOS based on symptom
data.</li>
<li>Identify the features most commonly associated with a PCOS
diagnosis.</li>
</ul>
<p>Our goal is to better understand which clinical indicators are most
predictive of PCOS, providing a foundation for early screening and
potential intervention strategies.</p>
</div>
<div class="cell markdown" id="WiaJcEyWOc8v">
<p>#Collaboration Plan We will meet every Monday (zoom or in person).
During this meeting we will come up with a task list for each of us to
make sure we are making progress. When we have milestone due we will
meet before we sumbit to go over our work and make sure it is
cohesive</p>
</div>
<section id="1-load-dataetl" class="cell markdown" id="O836qWnBJHCr">
<h1>1. Load data/ETL</h1>
<ul>
<li>Load data from .csv</li>
<li>Address any missing information</li>
</ul>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="75dTKt0Jov-J" data-outputId="83c8d427-96fe-44f4-c157-0575579e8cc8">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
/content/drive/MyDrive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="HIMTevvyTi4J" data-outputId="35dd0ba0-29eb-47bf-82f4-20210dd49407">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter nbconvert <span class="op">--</span>to html <span class="st">&quot;/content/drive/MyDrive/Colab Notebooks/final_tutorial.ipynb&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>[NbConvertApp] WARNING | pattern &#39;/content/drive/MyDrive/Colab Notebooks/final_tutorial.ipynb&#39; matched no files
This application is used to convert notebook files (*.ipynb)
        to various other formats.

        WARNING: THE COMMANDLINE INTERFACE MAY CHANGE IN FUTURE RELEASES.

Options
=======
The options below are convenience aliases to configurable class-options,
as listed in the &quot;Equivalent to&quot; description-line of the aliases.
To see all configurable class-options for some &lt;cmd&gt;, use:
    &lt;cmd&gt; --help-all

--debug
    set log level to logging.DEBUG (maximize logging output)
    Equivalent to: [--Application.log_level=10]
--show-config
    Show the application&#39;s configuration (human-readable format)
    Equivalent to: [--Application.show_config=True]
--show-config-json
    Show the application&#39;s configuration (json format)
    Equivalent to: [--Application.show_config_json=True]
--generate-config
    generate default config file
    Equivalent to: [--JupyterApp.generate_config=True]
-y
    Answer yes to any questions instead of prompting.
    Equivalent to: [--JupyterApp.answer_yes=True]
--execute
    Execute the notebook prior to export.
    Equivalent to: [--ExecutePreprocessor.enabled=True]
--allow-errors
    Continue notebook execution even if one of the cells throws an error and include the error message in the cell output (the default behaviour is to abort conversion). This flag is only relevant if &#39;--execute&#39; was specified, too.
    Equivalent to: [--ExecutePreprocessor.allow_errors=True]
--stdin
    read a single notebook file from stdin. Write the resulting notebook with default basename &#39;notebook.*&#39;
    Equivalent to: [--NbConvertApp.from_stdin=True]
--stdout
    Write notebook output to stdout instead of files.
    Equivalent to: [--NbConvertApp.writer_class=StdoutWriter]
--inplace
    Run nbconvert in place, overwriting the existing notebook (only
            relevant when converting to notebook format)
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory=]
--clear-output
    Clear output of current file and save in place,
            overwriting the existing notebook.
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory= --ClearOutputPreprocessor.enabled=True]
--coalesce-streams
    Coalesce consecutive stdout and stderr outputs into one stream (within each cell).
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory= --CoalesceStreamsPreprocessor.enabled=True]
--no-prompt
    Exclude input and output prompts from converted document.
    Equivalent to: [--TemplateExporter.exclude_input_prompt=True --TemplateExporter.exclude_output_prompt=True]
--no-input
    Exclude input cells and output prompts from converted document.
            This mode is ideal for generating code-free reports.
    Equivalent to: [--TemplateExporter.exclude_output_prompt=True --TemplateExporter.exclude_input=True --TemplateExporter.exclude_input_prompt=True]
--allow-chromium-download
    Whether to allow downloading chromium if no suitable version is found on the system.
    Equivalent to: [--WebPDFExporter.allow_chromium_download=True]
--disable-chromium-sandbox
    Disable chromium security sandbox when converting to PDF..
    Equivalent to: [--WebPDFExporter.disable_sandbox=True]
--show-input
    Shows code input. This flag is only useful for dejavu users.
    Equivalent to: [--TemplateExporter.exclude_input=False]
--embed-images
    Embed the images as base64 dataurls in the output. This flag is only useful for the HTML/WebPDF/Slides exports.
    Equivalent to: [--HTMLExporter.embed_images=True]
--sanitize-html
    Whether the HTML in Markdown cells and cell outputs should be sanitized..
    Equivalent to: [--HTMLExporter.sanitize_html=True]
--log-level=&lt;Enum&gt;
    Set the log level by value or name.
    Choices: any of [0, 10, 20, 30, 40, 50, &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARN&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;]
    Default: 30
    Equivalent to: [--Application.log_level]
--config=&lt;Unicode&gt;
    Full path of a config file.
    Default: &#39;&#39;
    Equivalent to: [--JupyterApp.config_file]
--to=&lt;Unicode&gt;
    The export format to be used, either one of the built-in formats
            [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;qtpdf&#39;, &#39;qtpng&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;, &#39;webpdf&#39;]
            or a dotted object name that represents the import path for an
            ``Exporter`` class
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.export_format]
--template=&lt;Unicode&gt;
    Name of the template to use
    Default: &#39;&#39;
    Equivalent to: [--TemplateExporter.template_name]
--template-file=&lt;Unicode&gt;
    Name of the template file to use
    Default: None
    Equivalent to: [--TemplateExporter.template_file]
--theme=&lt;Unicode&gt;
    Template specific theme(e.g. the name of a JupyterLab CSS theme distributed
    as prebuilt extension for the lab template)
    Default: &#39;light&#39;
    Equivalent to: [--HTMLExporter.theme]
--sanitize_html=&lt;Bool&gt;
    Whether the HTML in Markdown cells and cell outputs should be sanitized.This
    should be set to True by nbviewer or similar tools.
    Default: False
    Equivalent to: [--HTMLExporter.sanitize_html]
--writer=&lt;DottedObjectName&gt;
    Writer class used to write the
                                        results of the conversion
    Default: &#39;FilesWriter&#39;
    Equivalent to: [--NbConvertApp.writer_class]
--post=&lt;DottedOrNone&gt;
    PostProcessor class used to write the
                                        results of the conversion
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.postprocessor_class]
--output=&lt;Unicode&gt;
    Overwrite base name use for output files.
                Supports pattern replacements &#39;{notebook_name}&#39;.
    Default: &#39;{notebook_name}&#39;
    Equivalent to: [--NbConvertApp.output_base]
--output-dir=&lt;Unicode&gt;
    Directory to write output(s) to. Defaults
                                  to output to the directory of each notebook. To recover
                                  previous default behaviour (outputting to the current
                                  working directory) use . as the flag value.
    Default: &#39;&#39;
    Equivalent to: [--FilesWriter.build_directory]
--reveal-prefix=&lt;Unicode&gt;
    The URL prefix for reveal.js (version 3.x).
            This defaults to the reveal CDN, but can be any url pointing to a copy
            of reveal.js.
            For speaker notes to work, this must be a relative path to a local
            copy of reveal.js: e.g., &quot;reveal.js&quot;.
            If a relative path is given, it must be a subdirectory of the
            current directory (from which the server is run).
            See the usage documentation
            (https://nbconvert.readthedocs.io/en/latest/usage.html#reveal-js-html-slideshow)
            for more details.
    Default: &#39;&#39;
    Equivalent to: [--SlidesExporter.reveal_url_prefix]
--nbformat=&lt;Enum&gt;
    The nbformat version to write.
            Use this to downgrade notebooks.
    Choices: any of [1, 2, 3, 4]
    Default: 4
    Equivalent to: [--NotebookExporter.nbformat_version]

Examples
--------

    The simplest way to use nbconvert is

            &gt; jupyter nbconvert mynotebook.ipynb --to html

            Options include [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;qtpdf&#39;, &#39;qtpng&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;, &#39;webpdf&#39;].

            &gt; jupyter nbconvert --to latex mynotebook.ipynb

            Both HTML and LaTeX support multiple output templates. LaTeX includes
            &#39;base&#39;, &#39;article&#39; and &#39;report&#39;.  HTML includes &#39;basic&#39;, &#39;lab&#39; and
            &#39;classic&#39;. You can specify the flavor of the format used.

            &gt; jupyter nbconvert --to html --template lab mynotebook.ipynb

            You can also pipe the output to stdout, rather than a file

            &gt; jupyter nbconvert mynotebook.ipynb --stdout

            PDF is generated via latex

            &gt; jupyter nbconvert mynotebook.ipynb --to pdf

            You can get (and serve) a Reveal.js-powered slideshow

            &gt; jupyter nbconvert myslides.ipynb --to slides --post serve

            Multiple notebooks can be given at the command line in a couple of
            different ways:

            &gt; jupyter nbconvert notebook*.ipynb
            &gt; jupyter nbconvert notebook1.ipynb notebook2.ipynb

            or you can specify the notebooks list in a config file, containing::

                c.NbConvertApp.notebooks = [&quot;my_notebook.ipynb&quot;]

            &gt; jupyter nbconvert --config mycfg.py

To see all available configurables, use `--help-all`.

</code></pre>
</div>
</div>
<div class="cell markdown" id="zzqagUDgO6JT">
<p>The steps down below will be summarized here: We began by loading the
PCOS dataset (ideal_data) and cleaned it into a tidy format by removing
irrelevant identifiers, handling missing values, and converting
categorical variables (like blood_group) into numerical form using
one-hot encoding. We also dropped features with low variance and low
correlation to the target variable. One of the challenges was ensuring
that all features were numeric so they could be used in machine learning
models. By the end of this process, we had a well-structured dataset
suitable for predictive modeling, with clearly defined input features
and a binary target column (has_pcos).</p>
<p>Each step will take you through this with our PCOS dataset</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:325}"
id="kfgZnBa6pLkY" data-outputId="017b9327-267c-4032-d6a9-aba16c701f8c">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ideal_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;pcos_data.csv&#39;</span>) <span class="co">#store the data in a dataframe</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ideal_data.head() <span class="co">#display first five rows of data</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="2">

  <div id="df-dda190fa-984f-4ee0-8c7d-0f49016776be" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sl. No</th>
      <th>Patient File No.</th>
      <th>has_pcos</th>
      <th>Age (yrs)</th>
      <th>Weight (Kg)</th>
      <th>Height(Cm)</th>
      <th>BMI</th>
      <th>blood_group</th>
      <th>Pulse_rate(bpm)</th>
      <th>RR(breaths/min)</th>
      <th>...</th>
      <th>has_pimples</th>
      <th>eats_fast_food</th>
      <th>does_exercise</th>
      <th>BP _Systolic (mmHg)</th>
      <th>BP _Diastolic (mmHg)</th>
      <th>Follicle No. (L)</th>
      <th>Follicle No. (R)</th>
      <th>Avg. F size (L) (mm)</th>
      <th>Avg. F size (R) (mm)</th>
      <th>Endometrium (mm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>28</td>
      <td>44.6</td>
      <td>152.0</td>
      <td>19.300000</td>
      <td>O+</td>
      <td>78</td>
      <td>22</td>
      <td>...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>110</td>
      <td>80</td>
      <td>3</td>
      <td>3</td>
      <td>18.0</td>
      <td>18.0</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>36</td>
      <td>65.0</td>
      <td>161.5</td>
      <td>24.921163</td>
      <td>O+</td>
      <td>74</td>
      <td>20</td>
      <td>...</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>120</td>
      <td>70</td>
      <td>3</td>
      <td>5</td>
      <td>15.0</td>
      <td>14.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>33</td>
      <td>68.8</td>
      <td>165.0</td>
      <td>25.270891</td>
      <td>A+</td>
      <td>72</td>
      <td>18</td>
      <td>...</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>120</td>
      <td>80</td>
      <td>13</td>
      <td>15</td>
      <td>18.0</td>
      <td>20.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>37</td>
      <td>65.0</td>
      <td>148.0</td>
      <td>29.674945</td>
      <td>B+</td>
      <td>72</td>
      <td>20</td>
      <td>...</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>120</td>
      <td>70</td>
      <td>2</td>
      <td>2</td>
      <td>15.0</td>
      <td>14.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>25</td>
      <td>52.0</td>
      <td>161.0</td>
      <td>20.060954</td>
      <td>A+</td>
      <td>72</td>
      <td>18</td>
      <td>...</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>120</td>
      <td>80</td>
      <td>3</td>
      <td>4</td>
      <td>16.0</td>
      <td>14.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 44 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dda190fa-984f-4ee0-8c7d-0f49016776be')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dda190fa-984f-4ee0-8c7d-0f49016776be button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dda190fa-984f-4ee0-8c7d-0f49016776be');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-655d7220-00bf-4eb6-956d-e4c4226aafa7">
      <button class="colab-df-quickchart" onclick="quickchart('df-655d7220-00bf-4eb6-956d-e4c4226aafa7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-655d7220-00bf-4eb6-956d-e4c4226aafa7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="p7nP2cLyHhhz" data-outputId="6aed3bf5-f377-4207-8ca1-82f3430bda96">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ideal_data.shape <span class="co"># Display the number of rows and columns in the dataset (i.e., dataset dimensions)</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<pre><code>(541, 44)</code></pre>
</div>
</div>
<div class="cell markdown" id="t5VoQckiHtQa">
<p>We dropped the identification columns since it is not useful for
classification</p>
</div>
<div class="cell code" id="Rqj_04pvHkgq">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>id_cols <span class="op">=</span> [<span class="st">&#39;Sl. No&#39;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">&#39;Patient File No.&#39;</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ideal_data.drop(columns<span class="op">=</span>id_cols, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop identifier columns that do not contribute to prediction (e.g., serial number and file number)</span></span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="eRlINS3fHnLC" data-outputId="842d7a8a-91d6-4809-8409-08476dbdac94">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ideal_data.columns</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all column names in the dataset to review feature names after preprocessing</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<pre><code>Index([&#39;has_pcos&#39;, &#39; Age (yrs)&#39;, &#39;Weight (Kg)&#39;, &#39;Height(Cm) &#39;, &#39;BMI&#39;,
       &#39;blood_group&#39;, &#39;Pulse_rate(bpm) &#39;, &#39;RR(breaths/min)&#39;, &#39;Hb(g/dl)&#39;,
       &#39;Cycle(R/I)&#39;, &#39;Cycle_length(days)&#39;, &#39;Marriage_Status(Yrs)&#39;,
       &#39;is_pregnant&#39;, &#39;No._of _abortions&#39;, &#39;I_beta-HCG(mIU/mL)&#39;,
       &#39;II_beta-HCG(mIU/mL)&#39;, &#39;FSH(mIU/mL)&#39;, &#39;LH(mIU/mL)&#39;, &#39;FSH/LH&#39;,
       &#39;Hip(inch)&#39;, &#39;Waist(inch)&#39;, &#39;Waist:Hip Ratio&#39;, &#39;TSH (mIU/L)&#39;,
       &#39;AMH(ng/mL)&#39;, &#39;PRL(ng/mL)&#39;, &#39;Vit_D3(ng/mL)&#39;, &#39;PRG(ng/mL)&#39;, &#39;RBS(mg/dl)&#39;,
       &#39;has_weight_gain&#39;, &#39;has_hair_growth&#39;, &#39;has_hyperpigmentation&#39;,
       &#39;has_hair_loss&#39;, &#39;has_pimples&#39;, &#39;eats_fast_food&#39;, &#39;does_exercise&#39;,
       &#39;BP _Systolic (mmHg)&#39;, &#39;BP _Diastolic (mmHg)&#39;, &#39;Follicle No. (L)&#39;,
       &#39;Follicle No. (R)&#39;, &#39;Avg. F size (L) (mm)&#39;, &#39;Avg. F size (R) (mm)&#39;,
       &#39;Endometrium (mm)&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell markdown" id="5Z2ByLb6H20n">
<p>We are dropping the following features because they are not
realistically accessible during an initial or on-the-spot health
assessment. If we were to deploy a PCOS prediction tool for users to
input information themselves, we want to rely only on features that are
simple, observable, or easily reported — such as symptoms, lifestyle, or
basic vitals. Features like hormone levels (PRL, Vit_D3, I_beta-HCG),
ultrasound results (Follicle No. and Endometrium), or detailed blood
pressure readings require lab tests or clinical imaging, which may not
be available to the average user without a medical visit. Including
these would limit the practical use of the model for early or
self-assessment.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="mcP7h5-lHxYL" data-outputId="1f0f7969-0773-4d7b-dc41-3fdc17d94b8b">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bad_features <span class="op">=</span> [<span class="st">&#39;No._of _abortions&#39;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;I_beta-HCG(mIU/mL)&#39;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;II_beta-HCG(mIU/mL)&#39;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;PRL(ng/mL)&#39;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Vit_D3(ng/mL)&#39;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;BP _Systolic (mmHg)&#39;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;BP _Diastolic (mmHg)&#39;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Follicle No. (L)&#39;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Follicle No. (R)&#39;</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Avg. F size (L) (mm)&#39;</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Avg. F size (R) (mm)&#39;</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Endometrium (mm)&#39;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>ideal_data.drop(columns<span class="op">=</span>bad_features, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;Drop features that are irrelevant, contain excessive missing data, or have</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">unclear clinical significance for PCOS prediction&#39;&#39;&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<div class="sourceCode" id="cb12"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="a8Q6B5uKIgr2">
<p>The features retained in ideal_data represent information that is
generally easily accessible, whether through self-reporting,
observation, or basic clinical measurements. These include vital signs
(e.g., pulse rate, respiratory rate), anthropometric data (e.g., height,
weight, waist/hip measurements), lifestyle factors (e.g., exercise
habits, fast food consumption), and visible symptoms (e.g., hair growth,
pigmentation, pimples). We intentionally kept these features because
they are practical for a real-world predictive model — especially one
designed for early PCOS screening without requiring lab tests or
imaging. This ensures that users can input data independently or during
a routine clinical visit, making the model both scalable and
user-friendly.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8_ACUUtgIPvj" data-outputId="afe270ab-76ab-4ee8-9391-e7eaaab9acfd">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ideal_data.columns <span class="co">#store the data we want to keep</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>Index([&#39;has_pcos&#39;, &#39; Age (yrs)&#39;, &#39;Weight (Kg)&#39;, &#39;Height(Cm) &#39;, &#39;BMI&#39;,
       &#39;blood_group&#39;, &#39;Pulse_rate(bpm) &#39;, &#39;RR(breaths/min)&#39;, &#39;Hb(g/dl)&#39;,
       &#39;Cycle(R/I)&#39;, &#39;Cycle_length(days)&#39;, &#39;Marriage_Status(Yrs)&#39;,
       &#39;is_pregnant&#39;, &#39;FSH(mIU/mL)&#39;, &#39;LH(mIU/mL)&#39;, &#39;FSH/LH&#39;, &#39;Hip(inch)&#39;,
       &#39;Waist(inch)&#39;, &#39;Waist:Hip Ratio&#39;, &#39;TSH (mIU/L)&#39;, &#39;AMH(ng/mL)&#39;,
       &#39;PRG(ng/mL)&#39;, &#39;RBS(mg/dl)&#39;, &#39;has_weight_gain&#39;, &#39;has_hair_growth&#39;,
       &#39;has_hyperpigmentation&#39;, &#39;has_hair_loss&#39;, &#39;has_pimples&#39;,
       &#39;eats_fast_food&#39;, &#39;does_exercise&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="GzhlQ7biIizr" data-outputId="3e00db26-5d1f-40a4-93a7-42b81c510057">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ideal_data.isnull().<span class="bu">sum</span>()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in each column to identify which features may need imputation or removal</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>has_pcos</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Age (yrs)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Weight (Kg)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Height(Cm)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>0</td>
    </tr>
    <tr>
      <th>blood_group</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Pulse_rate(bpm)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>RR(breaths/min)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Hb(g/dl)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Cycle(R/I)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Cycle_length(days)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Marriage_Status(Yrs)</th>
      <td>1</td>
    </tr>
    <tr>
      <th>is_pregnant</th>
      <td>0</td>
    </tr>
    <tr>
      <th>FSH(mIU/mL)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>LH(mIU/mL)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>FSH/LH</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Hip(inch)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Waist(inch)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Waist:Hip Ratio</th>
      <td>0</td>
    </tr>
    <tr>
      <th>TSH (mIU/L)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AMH(ng/mL)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>PRG(ng/mL)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>RBS(mg/dl)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>has_weight_gain</th>
      <td>0</td>
    </tr>
    <tr>
      <th>has_hair_growth</th>
      <td>0</td>
    </tr>
    <tr>
      <th>has_hyperpigmentation</th>
      <td>0</td>
    </tr>
    <tr>
      <th>has_hair_loss</th>
      <td>0</td>
    </tr>
    <tr>
      <th>has_pimples</th>
      <td>0</td>
    </tr>
    <tr>
      <th>eats_fast_food</th>
      <td>1</td>
    </tr>
    <tr>
      <th>does_exercise</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:216}"
id="hSAAzcKZJWx4" data-outputId="ac87d020-e50c-4c9d-8f90-2d168e6d0be9">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ideal_data[ideal_data.isnull().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-0182d234-a689-4ae3-bb1f-65077302a6c9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>has_pcos</th>
      <th>Age (yrs)</th>
      <th>Weight (Kg)</th>
      <th>Height(Cm)</th>
      <th>BMI</th>
      <th>blood_group</th>
      <th>Pulse_rate(bpm)</th>
      <th>RR(breaths/min)</th>
      <th>Hb(g/dl)</th>
      <th>Cycle(R/I)</th>
      <th>...</th>
      <th>AMH(ng/mL)</th>
      <th>PRG(ng/mL)</th>
      <th>RBS(mg/dl)</th>
      <th>has_weight_gain</th>
      <th>has_hair_growth</th>
      <th>has_hyperpigmentation</th>
      <th>has_hair_loss</th>
      <th>has_pimples</th>
      <th>eats_fast_food</th>
      <th>does_exercise</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>156</th>
      <td>0</td>
      <td>27</td>
      <td>53.2</td>
      <td>158.0</td>
      <td>21.3</td>
      <td>B+</td>
      <td>72</td>
      <td>22</td>
      <td>10.5</td>
      <td>4</td>
      <td>...</td>
      <td>5.27</td>
      <td>0.36</td>
      <td>91.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>458</th>
      <td>1</td>
      <td>36</td>
      <td>66.0</td>
      <td>162.0</td>
      <td>25.1</td>
      <td>O+</td>
      <td>72</td>
      <td>20</td>
      <td>11.0</td>
      <td>4</td>
      <td>...</td>
      <td>6.6</td>
      <td>0.25</td>
      <td>93.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 30 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0182d234-a689-4ae3-bb1f-65077302a6c9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0182d234-a689-4ae3-bb1f-65077302a6c9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0182d234-a689-4ae3-bb1f-65077302a6c9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-efc285df-3577-4be6-97b3-972641162f4f">
      <button class="colab-df-quickchart" onclick="quickchart('df-efc285df-3577-4be6-97b3-972641162f4f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-efc285df-3577-4be6-97b3-972641162f4f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="cJq7NnWEGSif">
<p>Two samples have missing information. At least one of them is missing
a binary value, which would be difficult to impute. Drop them.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8JCn2VOwJa7b" data-outputId="0f1b19d6-0ed2-40b0-f6b4-d7ccd3c67136">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ideal_data.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ideal_data.shape</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#drop missing data, and now provide the new row/column</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>(539, 30)</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="a-r6svNOJb4G" data-outputId="0447e570-2c07-49b4-fcbd-58c648e1da32">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ideal_data.dtypes <span class="co">#display datatypes for each feature</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>has_pcos</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Age (yrs)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Weight (Kg)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>Height(Cm)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>blood_group</th>
      <td>object</td>
    </tr>
    <tr>
      <th>Pulse_rate(bpm)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>RR(breaths/min)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Hb(g/dl)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>Cycle(R/I)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Cycle_length(days)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Marriage_Status(Yrs)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>is_pregnant</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>FSH(mIU/mL)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>LH(mIU/mL)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>FSH/LH</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>Hip(inch)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Waist(inch)</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>Waist:Hip Ratio</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>TSH (mIU/L)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>AMH(ng/mL)</th>
      <td>object</td>
    </tr>
    <tr>
      <th>PRG(ng/mL)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>RBS(mg/dl)</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>has_weight_gain</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>has_hair_growth</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>has_hyperpigmentation</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>has_hair_loss</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>has_pimples</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>eats_fast_food</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>does_exercise</th>
      <td>int64</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> object</label>
</div>
</div>
<div class="cell markdown" id="Q3mqTIJ3GvSD">
<p>Here, we see that blood_group is categorical. We can address this via
one-hot encoding.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:461}"
id="e-z5ZiCYJohu" data-outputId="97ea9e48-814b-4e21-a11b-ab8594937e95">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ideal_data <span class="op">=</span> pd.get_dummies(ideal_data, columns<span class="op">=</span>[<span class="st">&quot;blood_group&quot;</span>], dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ideal_data</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#did one hot encoding to covert blood type to numerical values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="11">

  <div id="df-30c7ec11-6869-4336-93ee-3ecaddbd3f37" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>has_pcos</th>
      <th>Age (yrs)</th>
      <th>Weight (Kg)</th>
      <th>Height(Cm)</th>
      <th>BMI</th>
      <th>Pulse_rate(bpm)</th>
      <th>RR(breaths/min)</th>
      <th>Hb(g/dl)</th>
      <th>Cycle(R/I)</th>
      <th>Cycle_length(days)</th>
      <th>...</th>
      <th>eats_fast_food</th>
      <th>does_exercise</th>
      <th>blood_group_A+</th>
      <th>blood_group_A-</th>
      <th>blood_group_AB+</th>
      <th>blood_group_AB-</th>
      <th>blood_group_B+</th>
      <th>blood_group_B-</th>
      <th>blood_group_O+</th>
      <th>blood_group_O-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>28</td>
      <td>44.6</td>
      <td>152.000</td>
      <td>19.300000</td>
      <td>78</td>
      <td>22</td>
      <td>10.48</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>36</td>
      <td>65.0</td>
      <td>161.500</td>
      <td>24.921163</td>
      <td>74</td>
      <td>20</td>
      <td>11.70</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>33</td>
      <td>68.8</td>
      <td>165.000</td>
      <td>25.270891</td>
      <td>72</td>
      <td>18</td>
      <td>11.80</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>37</td>
      <td>65.0</td>
      <td>148.000</td>
      <td>29.674945</td>
      <td>72</td>
      <td>20</td>
      <td>12.00</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>25</td>
      <td>52.0</td>
      <td>161.000</td>
      <td>20.060954</td>
      <td>72</td>
      <td>18</td>
      <td>10.00</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>536</th>
      <td>0</td>
      <td>35</td>
      <td>50.0</td>
      <td>164.592</td>
      <td>18.500000</td>
      <td>72</td>
      <td>16</td>
      <td>11.00</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>537</th>
      <td>0</td>
      <td>30</td>
      <td>63.2</td>
      <td>158.000</td>
      <td>25.300000</td>
      <td>72</td>
      <td>18</td>
      <td>10.80</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>538</th>
      <td>0</td>
      <td>36</td>
      <td>54.0</td>
      <td>152.000</td>
      <td>23.400000</td>
      <td>74</td>
      <td>20</td>
      <td>10.80</td>
      <td>2</td>
      <td>6</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>539</th>
      <td>0</td>
      <td>27</td>
      <td>50.0</td>
      <td>150.000</td>
      <td>22.200000</td>
      <td>74</td>
      <td>20</td>
      <td>12.00</td>
      <td>4</td>
      <td>2</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>540</th>
      <td>1</td>
      <td>23</td>
      <td>82.0</td>
      <td>165.000</td>
      <td>30.100000</td>
      <td>80</td>
      <td>20</td>
      <td>10.20</td>
      <td>4</td>
      <td>7</td>
      <td>...</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>539 rows × 37 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-30c7ec11-6869-4336-93ee-3ecaddbd3f37')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-30c7ec11-6869-4336-93ee-3ecaddbd3f37 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-30c7ec11-6869-4336-93ee-3ecaddbd3f37');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-f55d78ce-c9fb-43aa-9226-8768733ad716">
      <button class="colab-df-quickchart" onclick="quickchart('df-f55d78ce-c9fb-43aa-9226-8768733ad716')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-f55d78ce-c9fb-43aa-9226-8768733ad716 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_3c264c1b-1c91-4df1-b982-a12075b24e92">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('ideal_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_3c264c1b-1c91-4df1-b982-a12075b24e92 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('ideal_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="DKJfxwCkG0p3">
<p>From the column dtypes, it also seems that AMH(ng/mL) may have some
non-numeric values. Let's explore this.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:147}"
id="nIZSJerCJvQa" data-outputId="61ceaab1-761b-49cb-dd98-964c0fd81d89">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ideal_data[pd.to_numeric(ideal_data[<span class="st">&#39;AMH(ng/mL)&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).isna()]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify rows where the &#39;AMH(ng/mL)&#39; column contains non-numeric values (e.g., strings, missing data).</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Converts the column to numeric, coercing errors to NaN, then filters rows where the result is NaN.</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-ebb9d34a-c619-41e1-a006-2f8812cd3eb2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>has_pcos</th>
      <th>Age (yrs)</th>
      <th>Weight (Kg)</th>
      <th>Height(Cm)</th>
      <th>BMI</th>
      <th>Pulse_rate(bpm)</th>
      <th>RR(breaths/min)</th>
      <th>Hb(g/dl)</th>
      <th>Cycle(R/I)</th>
      <th>Cycle_length(days)</th>
      <th>...</th>
      <th>eats_fast_food</th>
      <th>does_exercise</th>
      <th>blood_group_A+</th>
      <th>blood_group_A-</th>
      <th>blood_group_AB+</th>
      <th>blood_group_AB-</th>
      <th>blood_group_B+</th>
      <th>blood_group_B-</th>
      <th>blood_group_O+</th>
      <th>blood_group_O-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>305</th>
      <td>0</td>
      <td>37</td>
      <td>56.0</td>
      <td>152.0</td>
      <td>24.238227</td>
      <td>74</td>
      <td>20</td>
      <td>11.7</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 37 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ebb9d34a-c619-41e1-a006-2f8812cd3eb2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ebb9d34a-c619-41e1-a006-2f8812cd3eb2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ebb9d34a-c619-41e1-a006-2f8812cd3eb2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="oEOEy2whJzlj" data-outputId="0b5728e6-fba3-4a9e-c07c-0f4ea86e2844">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ideal_data[pd.to_numeric(ideal_data[<span class="st">&#39;AMH(ng/mL)&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).isna()].values)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ideal_data[<span class="st">&#39;AMH(ng/mL)&#39;</span>][<span class="dv">305</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;AMH(ng/mL) column average:&#39;</span>, pd.to_numeric(ideal_data[<span class="st">&#39;AMH(ng/mL)&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).mean())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[[0 37 56.0 152.0 24.23822715 74 20 11.7 2 5 9.0 0 2.91 0.35 8.314285714
  35 33 0.942857143 16.0 &#39;a&#39; 0.3 100.0 0 0 0 0 1 0.0 1 0 0 0 0 1 0 0 0]]
a
AMH(ng/mL) column average: 5.62303531598513
</code></pre>
</div>
</div>
<div class="cell markdown" id="7osZp3kZG9uH">
<p>Sure enough, row 305 has an 'a' in the AMH(ng/mL) column. We could
address this by replacing this value with the column mean via
imputing...</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="oTdDeSKbJ9wN" data-outputId="e8eb8774-f565-4bc3-bfe4-36c0163d2fa1">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> ideal_data.copy()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>test.replace(<span class="st">&#39;a&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>imp_mean <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.DataFrame(imp_mean.fit_transform(test), columns<span class="op">=</span>test.columns, index<span class="op">=</span>test.index)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;New value:&#39;</span>, test[<span class="st">&#39;AMH(ng/mL)&#39;</span>][<span class="dv">305</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>New value: 5.62303531598513
</code></pre>
</div>
</div>
<div class="cell markdown" id="cYXT4E3zHOyi">
<p>BUT this is an example of data leakage, as we are using information
from the entire dataset (mean) to address a single value which will
later be partitioned into the train or test set. Instead, it is easier
to just drop it.</p>
</div>
<div class="cell code" id="oHz_L_rjKApH">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ideal_data.drop(index<span class="op">=</span><span class="dv">305</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BFZzA6sKKE3u" data-outputId="16ca91a7-b27c-4848-9c35-31100565ca48">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;samples with pcos:&#39;</span>,ideal_data[ideal_data[<span class="st">&#39;has_pcos&#39;</span>]<span class="op">==</span><span class="dv">1</span>].shape[<span class="dv">0</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;samples without pcos:&#39;</span>,ideal_data[ideal_data[<span class="st">&#39;has_pcos&#39;</span>]<span class="op">==</span><span class="dv">0</span>].shape[<span class="dv">0</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>samples with pcos: 176
samples without pcos: 362
</code></pre>
</div>
</div>
<div class="cell markdown" id="SxbBzQgyHVRC">
<p>We have a notable class imbalance. We will have to address this when
training the models.</p>
</div>
<section
id="2-train-baseline-model-1-all-features-without-feature-selection-eda"
class="cell markdown" id="IhR-6sKTHYLP">
<h1>2. Train baseline model 1 (all features, without feature selection)
EDA</h1>
<p>Since the data is only moderately imbalanced (about 1:2), we can
balance the data using random oversampling. If we observe overfitting,
we can pivot to undersampling. To prevent data leakage, we should split
before oversampling.</p>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="czH-HHX3KImJ" data-outputId="9ad94412-9335-4f2d-87ee-1458e7c2d8c5">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> ideal_data.drop(columns<span class="op">=</span>[<span class="st">&#39;has_pcos&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ideal_data[<span class="st">&#39;has_pcos&#39;</span>].values</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;X_train:&#39;</span>,X_train.shape)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;y_train:&#39;</span>,y_train.shape)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;X_test:&#39;</span>,X_test.shape)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;y_test:&#39;</span>,y_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>X_train: (376, 36)
y_train: (376,)
X_test: (162, 36)
y_test: (162,)
</code></pre>
</div>
</div>
<div class="cell markdown" id="Avy0cKFpHqHE">
<p>While some classifiers do not require scaling, we should scale our
data to make best use of certain classifiers.</p>
</div>
<div class="cell code" id="t-Kcu_W6KKWb">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Only fit scaler to X_train to prevent data leakage</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>scaler.fit(X_train)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span>scaler.transform(X_train)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span>scaler.transform(X_test)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:290}"
id="burEYVv9Ni2K" data-outputId="1db64524-28d1-433c-b8ae-96cf55cee210">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score, roc_auc_score, brier_score_loss</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;Logistic Regression&#39;</span>, LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;Random Forest&#39;</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;K Nearest Neighbors&#39;</span>, KNeighborsClassifier()), <span class="co"># Added KNN</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate models</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate metrics</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    roc_auc <span class="op">=</span> roc_auc_score(y_test, y_pred)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    brier_score <span class="op">=</span> brier_score_loss(y_test, y_pred)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    fpr <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> recall_score(y_test, y_pred, pos_label<span class="op">=</span><span class="dv">0</span>) <span class="co"># False Positive Rate</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    results.append([name, accuracy, precision, recall, f1, roc_auc, fpr, brier_score])</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame for results</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>base_1_metrics <span class="op">=</span> pd.DataFrame(results, columns<span class="op">=</span>[<span class="st">&#39;Name&#39;</span>, <span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Precision&#39;</span>, <span class="st">&#39;Recall&#39;</span>, <span class="st">&#39;F1&#39;</span>, <span class="st">&#39;ROC AUC&#39;</span>, <span class="st">&#39;FPR&#39;</span>, <span class="st">&#39;Brier Score&#39;</span>])</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you can save the results to CSV</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>base_1_metrics.to_csv(<span class="st">&#39;no_scale_base_metrics.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>base_1_metrics</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.11/dist-packages/sklearn/linear_model/_logistic.py:465: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</code></pre>
</div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-d8021472-c20d-4099-b202-06fc30b5a361" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1</th>
      <th>ROC AUC</th>
      <th>FPR</th>
      <th>Brier Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression</td>
      <td>0.820988</td>
      <td>0.734694</td>
      <td>0.692308</td>
      <td>0.712871</td>
      <td>0.787063</td>
      <td>0.118182</td>
      <td>0.179012</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest</td>
      <td>0.802469</td>
      <td>0.727273</td>
      <td>0.615385</td>
      <td>0.666667</td>
      <td>0.753147</td>
      <td>0.109091</td>
      <td>0.197531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K Nearest Neighbors</td>
      <td>0.617284</td>
      <td>0.380952</td>
      <td>0.307692</td>
      <td>0.340426</td>
      <td>0.535664</td>
      <td>0.236364</td>
      <td>0.382716</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d8021472-c20d-4099-b202-06fc30b5a361')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d8021472-c20d-4099-b202-06fc30b5a361 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d8021472-c20d-4099-b202-06fc30b5a361');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6115cc0c-5988-4ad2-8350-28aa7cef0e32">
      <button class="colab-df-quickchart" onclick="quickchart('df-6115cc0c-5988-4ad2-8350-28aa7cef0e32')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6115cc0c-5988-4ad2-8350-28aa7cef0e32 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_f0bc68fc-8017-42b9-8a04-8e2eda0f91f5">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('base_1_metrics')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_f0bc68fc-8017-42b9-8a04-8e2eda0f91f5 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('base_1_metrics');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="jrFPDJnBIJgL">
<p>We implemented three predictive modeling techniques — Logistic
Regression, Random Forest, and K-Nearest Neighbors (KNN) — to classify
individuals as having PCOS or not. To evaluate model performance, we
used several metrics: Accuracy, Recall, Precision, F1 Score, ROC AUC,
False Positive Rate (FPR), and Brier Score.</p>
<p>Logistic Regression consistently performed the best overall,
achieving the highest scores in most metrics including Accuracy, ROC
AUC, and F1 Score, indicating strong balanced performance.</p>
<p>Random Forest showed competitive results, particularly in Recall,
making it effective for minimizing false negatives.</p>
<p>KNN performed the lowest across most metrics, especially in Precision
and F1, suggesting it was less reliable for this dataset.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:644}"
id="c2vJCCdaOZZd" data-outputId="903de5ca-4a5d-4327-c870-df25f599722c">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_model_performance(df):</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a simplified grouped bar plot to visualize model performance metrics.</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">    df (pandas.DataFrame): DataFrame containing model performance metrics</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Metrics to plot</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    metrics <span class="op">=</span> [<span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Recall&#39;</span>, <span class="st">&#39;Precision&#39;</span>, <span class="st">&#39;F1&#39;</span>, <span class="st">&#39;ROC AUC&#39;</span>, <span class="st">&#39;FPR&#39;</span>, <span class="st">&#39;Brier Score&#39;</span>]</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Melt the dataframe to create a long-format dataframe</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    df_melted <span class="op">=</span> df.melt(id_vars<span class="op">=</span><span class="st">&#39;Name&#39;</span>, value_vars<span class="op">=</span>metrics, var_name<span class="op">=</span><span class="st">&#39;Metric&#39;</span>, value_name<span class="op">=</span><span class="st">&#39;Score&#39;</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the plot</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a custom color palette</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    custom_palette <span class="op">=</span> sns.color_palette(<span class="st">&quot;Set2&quot;</span>)  <span class="co"># Use Set2 palette for distinct colors</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    custom_palette[df[<span class="st">&#39;Name&#39;</span>].tolist().index(<span class="st">&#39;Random Forest&#39;</span>)] <span class="op">=</span> (<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="co"># Set Random Forest to dark grey</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the plot using Seaborn</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    sns.barplot(</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">&#39;Metric&#39;</span>,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">&#39;Score&#39;</span>,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span><span class="st">&#39;Name&#39;</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>df_melted,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span>custom_palette</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Customize the plot</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Model Performance Comparison&#39;</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    plt.legend(title<span class="op">=</span><span class="st">&#39;Models&#39;</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show the plot</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>plot_model_performance(base_1_metrics)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-23-77013dd17118&gt;:25: UserWarning: The palette list has more values (8) than needed (3), which may not be intended.
  sns.barplot(
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5dbbeac7ae324ae6ab5ad7f61bb4c898/b15b2c226991cf68287bf93cd2ed3e6b61dc3387.png" /></p>
</div>
</div>
<div class="cell markdown" id="Ec39j-K-IVfB">
<p>#3 Feature Selection We are performing feature selection to identify
the most relevant variables that contribute to predicting whether
someone has PCOS. In the previous section, we trained models using all
available features in the dataset. While this can be useful as a
baseline, it often includes noisy, redundant, or irrelevant data that
may reduce model performance or lead to overfitting. By removing the
target variable has_pcos and focusing on the remaining features in X_df,
we can:</p>
<ul>
<li>Train models on a cleaner, more focused dataset</li>
<li>Improve interpretability by highlighting which features are most
predictive - Reduce computational complexity</li>
<li>Potentially boost model generalization to new data</li>
</ul>
<p>This process allows us to better understand which clinical indicators
are most strongly associated with PCOS and supports the development of a
more streamlined, accurate predictive model.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="c3ruIHGNtBqa" data-outputId="87223d83-4bf7-4932-dbb8-bf5aac53d5cb">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>X_df <span class="op">=</span> ideal_data.drop(columns<span class="op">=</span>[<span class="st">&#39;has_pcos&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>y_df <span class="op">=</span> ideal_data[<span class="st">&#39;has_pcos&#39;</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>X_train_df, X_test_df, y_train_df, y_test_df <span class="op">=</span> train_test_split(X_df, y_df, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;X_train:&#39;</span>,X_train_df.shape)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;y_train:&#39;</span>,y_train_df.shape)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;X_test:&#39;</span>,X_test_df.shape)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;y_test:&#39;</span>,y_test_df.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>X_train: (376, 36)
y_train: (376,)
X_test: (162, 36)
y_test: (162,)
</code></pre>
</div>
</div>
<div class="cell markdown" id="_x057Ga0JFFX">
<p>We used .describe().T.sort_values(by='std') to examine the
statistical distribution of each feature in the training set, focusing
on standard deviation. This helps us understand which features have the
most variability across the dataset — a key factor in identifying
informative predictors. Features with very low standard deviation may
have little discriminative power and can potentially be removed during
feature selection.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="NFShAbK1t0yo" data-outputId="27d85df4-f8b4-4358-e2fe-586224e94cd9">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>X_train_df.describe().T.sort_values(by<span class="op">=</span><span class="st">&#39;std&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">

  <div id="df-4075a693-3578-4360-aafe-771d3c20e517" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Waist:Hip Ratio</th>
      <td>376.0</td>
      <td>0.890910</td>
      <td>0.047043</td>
      <td>0.761905</td>
      <td>0.857143</td>
      <td>0.894737</td>
      <td>0.929762</td>
      <td>0.979167</td>
    </tr>
    <tr>
      <th>blood_group_AB-</th>
      <td>376.0</td>
      <td>0.002660</td>
      <td>0.051571</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_A-</th>
      <td>376.0</td>
      <td>0.023936</td>
      <td>0.153054</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_B-</th>
      <td>376.0</td>
      <td>0.026596</td>
      <td>0.161113</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_O-</th>
      <td>376.0</td>
      <td>0.034574</td>
      <td>0.182943</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_AB+</th>
      <td>376.0</td>
      <td>0.069149</td>
      <td>0.254045</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_A+</th>
      <td>376.0</td>
      <td>0.199468</td>
      <td>0.400133</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>does_exercise</th>
      <td>376.0</td>
      <td>0.247340</td>
      <td>0.432041</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_B+</th>
      <td>376.0</td>
      <td>0.255319</td>
      <td>0.436621</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>has_hair_growth</th>
      <td>376.0</td>
      <td>0.276596</td>
      <td>0.447911</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>has_hyperpigmentation</th>
      <td>376.0</td>
      <td>0.308511</td>
      <td>0.462494</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>blood_group_O+</th>
      <td>376.0</td>
      <td>0.388298</td>
      <td>0.488012</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>has_weight_gain</th>
      <td>376.0</td>
      <td>0.390957</td>
      <td>0.488615</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>is_pregnant</th>
      <td>376.0</td>
      <td>0.398936</td>
      <td>0.490332</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>has_hair_loss</th>
      <td>376.0</td>
      <td>0.465426</td>
      <td>0.499468</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>has_pimples</th>
      <td>376.0</td>
      <td>0.521277</td>
      <td>0.500213</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>eats_fast_food</th>
      <td>376.0</td>
      <td>0.515957</td>
      <td>0.500411</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>Hb(g/dl)</th>
      <td>376.0</td>
      <td>11.184335</td>
      <td>0.858237</td>
      <td>8.500000</td>
      <td>10.500000</td>
      <td>11.000000</td>
      <td>11.800000</td>
      <td>14.800000</td>
    </tr>
    <tr>
      <th>Cycle(R/I)</th>
      <td>376.0</td>
      <td>2.550532</td>
      <td>0.898947</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>Cycle_length(days)</th>
      <td>376.0</td>
      <td>4.960106</td>
      <td>1.489878</td>
      <td>2.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>RR(breaths/min)</th>
      <td>376.0</td>
      <td>19.289894</td>
      <td>1.746159</td>
      <td>16.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>20.000000</td>
      <td>28.000000</td>
    </tr>
    <tr>
      <th>LH(mIU/mL)</th>
      <td>376.0</td>
      <td>2.692106</td>
      <td>2.229287</td>
      <td>0.020000</td>
      <td>1.007500</td>
      <td>2.280000</td>
      <td>3.612500</td>
      <td>14.690000</td>
    </tr>
    <tr>
      <th>Waist(inch)</th>
      <td>376.0</td>
      <td>33.728723</td>
      <td>3.522245</td>
      <td>24.000000</td>
      <td>32.000000</td>
      <td>34.000000</td>
      <td>36.000000</td>
      <td>47.000000</td>
    </tr>
    <tr>
      <th>Hip(inch)</th>
      <td>376.0</td>
      <td>37.912234</td>
      <td>3.900121</td>
      <td>26.000000</td>
      <td>36.000000</td>
      <td>38.000000</td>
      <td>40.000000</td>
      <td>48.000000</td>
    </tr>
    <tr>
      <th>Pulse_rate(bpm)</th>
      <td>376.0</td>
      <td>73.215426</td>
      <td>4.035691</td>
      <td>13.000000</td>
      <td>72.000000</td>
      <td>72.000000</td>
      <td>74.000000</td>
      <td>82.000000</td>
    </tr>
    <tr>
      <th>BMI</th>
      <td>376.0</td>
      <td>24.301822</td>
      <td>4.112859</td>
      <td>12.417882</td>
      <td>21.900000</td>
      <td>24.400000</td>
      <td>26.411228</td>
      <td>38.900000</td>
    </tr>
    <tr>
      <th>TSH (mIU/L)</th>
      <td>376.0</td>
      <td>3.118226</td>
      <td>4.251473</td>
      <td>0.040000</td>
      <td>1.510000</td>
      <td>2.285000</td>
      <td>3.642500</td>
      <td>65.000000</td>
    </tr>
    <tr>
      <th>PRG(ng/mL)</th>
      <td>376.0</td>
      <td>0.631306</td>
      <td>4.380906</td>
      <td>0.047000</td>
      <td>0.250000</td>
      <td>0.310000</td>
      <td>0.450000</td>
      <td>85.000000</td>
    </tr>
    <tr>
      <th>Marriage_Status(Yrs)</th>
      <td>376.0</td>
      <td>7.761170</td>
      <td>4.896718</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>7.000000</td>
      <td>11.000000</td>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>Age (yrs)</th>
      <td>376.0</td>
      <td>31.454787</td>
      <td>5.380268</td>
      <td>20.000000</td>
      <td>27.000000</td>
      <td>31.000000</td>
      <td>35.000000</td>
      <td>48.000000</td>
    </tr>
    <tr>
      <th>Height(Cm)</th>
      <td>376.0</td>
      <td>156.400426</td>
      <td>5.881315</td>
      <td>137.000000</td>
      <td>152.000000</td>
      <td>156.000000</td>
      <td>160.000000</td>
      <td>180.000000</td>
    </tr>
    <tr>
      <th>Weight (Kg)</th>
      <td>376.0</td>
      <td>59.536702</td>
      <td>11.001056</td>
      <td>31.000000</td>
      <td>52.000000</td>
      <td>60.000000</td>
      <td>65.000000</td>
      <td>104.000000</td>
    </tr>
    <tr>
      <th>RBS(mg/dl)</th>
      <td>376.0</td>
      <td>99.545745</td>
      <td>15.333680</td>
      <td>60.000000</td>
      <td>92.000000</td>
      <td>100.000000</td>
      <td>107.000000</td>
      <td>225.000000</td>
    </tr>
    <tr>
      <th>FSH/LH</th>
      <td>376.0</td>
      <td>8.280657</td>
      <td>72.708295</td>
      <td>0.416944</td>
      <td>1.443450</td>
      <td>2.204917</td>
      <td>4.121646</td>
      <td>1372.826087</td>
    </tr>
    <tr>
      <th>FSH(mIU/mL)</th>
      <td>376.0</td>
      <td>18.819266</td>
      <td>260.309577</td>
      <td>1.000000</td>
      <td>3.350000</td>
      <td>4.815000</td>
      <td>6.400000</td>
      <td>5052.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4075a693-3578-4360-aafe-771d3c20e517')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4075a693-3578-4360-aafe-771d3c20e517 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4075a693-3578-4360-aafe-771d3c20e517');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-c6eff828-5d52-4899-86c7-a97db7bfd2bc">
      <button class="colab-df-quickchart" onclick="quickchart('df-c6eff828-5d52-4899-86c7-a97db7bfd2bc')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-c6eff828-5d52-4899-86c7-a97db7bfd2bc button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="4J2hA5mXJQsz">
<p>We dropped the 'Waist:Hip Ratio' feature from both the training and
test sets due to its extremely low variance. Features with little to no
variation provide minimal predictive value and can negatively impact
model performance. Removing them helps reduce noise and simplify the
model.</p>
</div>
<div class="cell code" id="Nu-N44sXt5uE">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>low_var_cols <span class="op">=</span> [<span class="st">&#39;Waist:Hip Ratio&#39;</span>]  <span class="co"># Only keep the &#39;Waist:Hip Ratio&#39; column for now</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> low_var_cols:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> X_train_df.columns:  <span class="co"># Check if the column exists before dropping</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        X_train_df.drop(columns<span class="op">=</span>[col], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> X_test_df.columns:  <span class="co"># Check if the column exists before dropping</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        X_test_df.drop(columns<span class="op">=</span>[col], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="B2fCrqVQJhOM">
<p>We generated this correlation matrix to explore the relationships
between different numerical features in our dataset. This helps us
identify highly correlated variables, which can be redundant and
potentially harm model performance due to multicollinearity. It also
allows us to uncover which clinical or behavioral indicators are
associated with each other — for example, we observed strong positive
correlations between weight-related variables (like BMI, Waist, and Hip
measurements), which is expected. This analysis guides our feature
selection process by highlighting features that provide unique and
relevant information.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:911}"
id="NhUlHIFe2K8e" data-outputId="90ca4b40-623a-4111-e057-d42a796ba219">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Keep only numeric columns for correlation</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>numeric_df <span class="op">=</span> X_train_df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute the correlation matrix</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> numeric_df.corr()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Generate a mask for the upper triangle</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Set up the matplotlib figure</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">9</span>))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Generate a custom diverging colormap</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sns.diverging_palette(<span class="dv">230</span>, <span class="dv">20</span>, as_cmap<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Draw the heatmap</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, mask<span class="op">=</span>mask, cmap<span class="op">=</span>cmap, vmax<span class="op">=</span><span class="fl">0.3</span>, center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, cbar_kws<span class="op">=</span>{<span class="st">&quot;shrink&quot;</span>: <span class="fl">0.5</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5dbbeac7ae324ae6ab5ad7f61bb4c898/e0863634a319c963c715691313b33ab8d780d583.png" /></p>
</div>
</div>
<div class="cell markdown" id="81N4fNmCJsYc">
<p>We generated this heatmap to visualize the correlation between each
feature and the target variable has_pcos. This helps us identify which
features are most strongly associated with a PCOS diagnosis. Features
such as has_hyperpigmentation, has_hair_growth, has_weight_gain, and
eats_fast_food show the highest positive correlations, suggesting they
may be important indicators for prediction. By sorting features based on
their absolute correlation values, we can prioritize the most relevant
features during model training and feature selection.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:771}"
id="2B-g4M3mreyv" data-outputId="a59ff4da-370e-458c-d5a3-3cd62a30da20">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>corrwith <span class="op">=</span> X_train_df.corrwith(y_train_df)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">9</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a custom diverging colormap</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sns.diverging_palette(<span class="dv">230</span>, <span class="dv">20</span>, as_cmap<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the heatmap with annotations</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>sns.heatmap(</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(corrwith).sort_values(by<span class="op">=</span><span class="dv">0</span>, key<span class="op">=</span><span class="bu">abs</span>, ascending<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>cmap,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    vmax<span class="op">=</span><span class="fl">.3</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="fl">.5</span>,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    cbar_kws<span class="op">=</span>{<span class="st">&quot;shrink&quot;</span>: <span class="fl">.5</span>},</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    annot<span class="op">=</span><span class="va">True</span>,  <span class="co"># Annotate the heatmap with correlation values</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>    <span class="co"># Format the annotation with two decimal points</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5dbbeac7ae324ae6ab5ad7f61bb4c898/9cf33735eddab6d5d3c7843b14dd45c88a07c147.png" /></p>
</div>
</div>
<div class="cell markdown" id="G9n5T5hVJ-0P">
<p>This histogram was created to show the overall distribution of
correlation strengths between individual features and the PCOS diagnosis
variable. Unlike the previous heatmap, which visualized correlations for
each specific feature, this plot gives us a summary view of how many
features fall into different correlation ranges. It helps answer the
question: “How informative is the dataset overall?” From the plot, we
can see that most features have very low correlation values, meaning
only a small subset of features may be significantly useful for
prediction. This broader statistical overview supports decisions about
dimensionality reduction and setting correlation-based thresholds for
feature filtering.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:571}"
id="m2KWzOedrmgh" data-outputId="32e28e96-238e-4fe7-9d30-17736abae73b">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the custom diverging colormap</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sns.diverging_palette(<span class="dv">230</span>, <span class="dv">20</span>, as_cmap<span class="op">=</span><span class="va">False</span>)  <span class="co"># `as_cmap=False` returns a list of colors</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the values from the DataFrame and flatten them</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>sns.histplot(corrwith.<span class="bu">abs</span>(), bins<span class="op">=</span><span class="dv">20</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span>cmap[<span class="dv">0</span>], edgecolor<span class="op">=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Histogram of Correlation Values&quot;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Correlation Value&quot;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Frequency&quot;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5dbbeac7ae324ae6ab5ad7f61bb4c898/60deac29b2d32e911be7f2de45d212b43a0d12dd.png" /></p>
</div>
</div>
<div class="cell markdown" id="u_dsRun8KKFe">
<p>We dropped features that had very low correlation with the PCOS
diagnosis to streamline our dataset and retain only variables that may
contribute meaningful predictive value.</p>
</div>
<div class="cell code" id="jAJrLgFZrswm">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>low_corrwith_cols <span class="op">=</span> [<span class="st">&#39;blood_group_B+&#39;</span>, <span class="st">&#39;blood_group_A+&#39;</span>, <span class="st">&#39;blood_group_O+&#39;</span>, <span class="st">&#39;RR(breaths/min)&#39;</span>, <span class="st">&#39;TSH (mIU/L)&#39;</span>, <span class="st">&#39;FSH/LH&#39;</span>,<span class="st">&#39;RBS(mg/dl)&#39;</span>,<span class="st">&#39;is_pregnant&#39;</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>X_train_df.drop(columns<span class="op">=</span>low_corrwith_cols, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>X_test_df.drop(columns<span class="op">=</span>low_corrwith_cols, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="H9sHuz7Erw83">
<p>#4 Train model (w/ feature selection)</p>
</div>
<div class="cell code" id="O-jGRy8KsIqr">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_train_df.values</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test_df.values</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> y_train_df.values</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> y_test_df.values</span></code></pre></div>
</div>
<div class="cell code" id="oLvwDFWfsM1z">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Only fit scaler to X_train to prevent data leakage</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>scaler.fit(X_train)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span>scaler.transform(X_train)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span>scaler.transform(X_test)</span></code></pre></div>
</div>
<div class="cell markdown" id="z2Xn3ZLSKfB3">
<p>After performing feature selection to remove low-variance and
low-correlation features, we retrained our models — Logistic Regression,
Random Forest, and K-Nearest Neighbors — on the refined dataset. This
updated performance comparison helps us assess how model accuracy and
reliability changed after reducing noise and dimensionality.</p>
<p>Overall, we observe that Logistic Regression continues to perform
best, showing strong scores across all metrics including Accuracy, F1,
and ROC AUC, while maintaining a low False Positive Rate and Brier
Score. Notably, the performance gap between models narrowed slightly,
indicating that feature selection improved generalization across all
three algorithms. This demonstrates the value of selecting only the most
informative features when building predictive models for PCOS
diagnosis.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:143}"
id="tIfc0KjesQtI" data-outputId="f9e13105-f569-4a50-b852-0c376274147c">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;Logistic Regression&#39;</span>, LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;Random Forest&#39;</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;K Nearest Neighbors&#39;</span>, KNeighborsClassifier()), <span class="co"># Added KNN</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate models</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate metrics</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    roc_auc <span class="op">=</span> roc_auc_score(y_test, y_pred)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    brier_score <span class="op">=</span> brier_score_loss(y_test, y_pred)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    fpr <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> recall_score(y_test, y_pred, pos_label<span class="op">=</span><span class="dv">0</span>) <span class="co"># False Positive Rate</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    results.append([name, accuracy, precision, recall, f1, roc_auc, fpr, brier_score])</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame for results</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>ideal_metrics <span class="op">=</span> pd.DataFrame(results, columns<span class="op">=</span>[<span class="st">&#39;Name&#39;</span>, <span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Precision&#39;</span>, <span class="st">&#39;Recall&#39;</span>, <span class="st">&#39;F1&#39;</span>, <span class="st">&#39;ROC AUC&#39;</span>, <span class="st">&#39;FPR&#39;</span>, <span class="st">&#39;Brier Score&#39;</span>])</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you can save the results to CSV</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>ideal_metrics.to_csv(<span class="st">&#39;ideal_metrics.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>ideal_metrics</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">

  <div id="df-80d65e4e-4124-4a83-bf57-33111d7003eb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1</th>
      <th>ROC AUC</th>
      <th>FPR</th>
      <th>Brier Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression</td>
      <td>0.851852</td>
      <td>0.804348</td>
      <td>0.711538</td>
      <td>0.755102</td>
      <td>0.814860</td>
      <td>0.081818</td>
      <td>0.148148</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest</td>
      <td>0.802469</td>
      <td>0.738095</td>
      <td>0.596154</td>
      <td>0.659574</td>
      <td>0.748077</td>
      <td>0.100000</td>
      <td>0.197531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K Nearest Neighbors</td>
      <td>0.833333</td>
      <td>0.765957</td>
      <td>0.692308</td>
      <td>0.727273</td>
      <td>0.796154</td>
      <td>0.100000</td>
      <td>0.166667</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-80d65e4e-4124-4a83-bf57-33111d7003eb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-80d65e4e-4124-4a83-bf57-33111d7003eb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-80d65e4e-4124-4a83-bf57-33111d7003eb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-b7bda50d-a216-43d8-8240-9e33b75b321e">
      <button class="colab-df-quickchart" onclick="quickchart('df-b7bda50d-a216-43d8-8240-9e33b75b321e')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-b7bda50d-a216-43d8-8240-9e33b75b321e button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_b2e01eb1-e5ec-463e-a259-4be11a2818e7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('ideal_metrics')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_b2e01eb1-e5ec-463e-a259-4be11a2818e7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('ideal_metrics');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:644}"
id="YrjhLDu5si_D" data-outputId="fe59ce59-b58c-467e-dfc9-13df8d9049cc">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>plot_model_performance(ideal_metrics)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-23-77013dd17118&gt;:25: UserWarning: The palette list has more values (8) than needed (3), which may not be intended.
  sns.barplot(
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5dbbeac7ae324ae6ab5ad7f61bb4c898/c7441859c63a59e04fd482b2f7de1b0ca6e2f690.png" /></p>
</div>
</div>
<div class="cell markdown" id="2eqOGp2IONxi">
<p>In this project, we explored multiple models to predict PCOS
diagnosis based on clinical, demographic, and behavioral features. We
tested our models under two conditions — one using all available
features, and another using a feature-selected subset. In both cases, we
compared Logistic Regression, Random Forest, and K-Nearest Neighbors
using performance metrics like Accuracy, F1 Score, and ROC AUC.</p>
<p>Going forward, we plan to explore two main directions:</p>
<ol>
<li><p>Refine the PCOS prediction model using top-ranked features. We
plan to finalize a predictive model based on the most correlated
features identified through our correlation heatmaps and visualizations.
This will help us build a more interpretable and generalizable
classifier.</p></li>
<li><p>Analyze feature importance and explore causal relationships.
Using tools like permutation importance or SHAP values, we aim to
understand which features most influence the model’s prediction. This
could uncover deeper clinical insights into which symptoms are the
strongest indicators of PCOS.</p></li>
</ol>
</div>
</body>
</html>
